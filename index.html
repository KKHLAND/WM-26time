<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personalized High School Timetable</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Noto Sans KR', Arial, sans-serif;
      }
      
      .dynamic-text-large {
        font-size: clamp(1rem, 3.5vw, 1.5rem);
        line-height: 1.2;
      }
      .dynamic-text-small {
        font-size: clamp(0.75rem, 2.8vw, 1rem);
        line-height: 1.2;
      }

      @page {
        margin: 1cm;
      }

      @media print {
        html, body {
            height: 99%;
            overflow: hidden;
            visibility: visible;
        }
        body > *:not(#root) { display: none; }
        #root > div > div > *:not(.printing) { display: none; }
        
        .no-print, .no-print * {
           visibility: hidden !important;
           display: none !important;
        }

        .printing {
          visibility: visible !important;
          position: absolute; left: 0; top: 0;
          width: 100% !important; height: auto !important;
          margin: 0 !important; padding: 0 !important;
          box-shadow: none !important;
          border: none !important;
        }
        .printing * {
          visibility: visible;
        }

        /* --- ğŸ‘‡ ëª¨ë“  í…Œì´ë¸” ìš”ì†Œì˜ ê·¸ë¦¼ì íš¨ê³¼ ì œê±° --- */
        .printing table, .printing th, .printing td {
            box-shadow: none !important;
            border-style: solid !important;
        }

        th, td {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
            text-align: center !important;
            vertical-align: middle !important;
        }

        /* --- ì‹œê°„í‘œ ì¸ì‡„ (ì„¸ë¡œ) --- */
        body.printing-portrait {
            @page { size: A4 portrait; }
            #printable-area {
                padding: 1cm !important;
                zoom: 88%;
            }
            #printable-area h1 { font-size: 2.2rem !important; }
            #printable-area table th { font-size: 16pt !important; }
            #printable-area .bg-yellow-400 { background-color: #facc15 !important; }
        }

        /* --- ì„ íƒê³¼ëª© ì¸ì‡„ (ê°€ë¡œ) --- */
        body.printing-landscape {
            @page { size: A4 landscape; }
            #student-printable-area {
                padding: 0.5cm !important;
                zoom: 64%; 
            }
            #student-printable-area h1 { font-size: 1.5rem !important; margin-bottom: 0.5rem !important; }
            #student-printable-area .overflow-x-auto { overflow: visible !important; }
            #student-printable-area table { font-size: 11pt !important; }
            #student-printable-area th, #student-printable-area td {
                padding: 5px 3px !important; 
                border: 1px solid #ccc !important;
            }
            #student-printable-area thead th {
                background-color: #dbeafe !important;
            }
        }
      }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        // --- React and Data Section ---
        const { useState, useMemo, useEffect, useCallback } = React;

        // --- Data Section ---
        const semester1Csv = `ìš”ì¼,ì›”,,,,,,í™”,,,,,,,ìˆ˜,,,,,,ëª©,,,,,,,ê¸ˆ,,,,,
êµì‚¬ëª…/êµì‹œ,1,2,3,4,5,6,1,2,3,4,5,6,7,1,2,3,4,5,6,1,2,3,4,5,6,7,1,2,3,4,5,6
ê¹€í˜œì›,,106,,104,,,,105,108,,101,,107,103,105,,,106,102,101,,,103,,108,104,,102,,107,ì°½ì²´,ì°½ì²´,
16,,êµ­ì–´A,,êµ­ì–´A,,,,êµ­ì–´A,êµ­ì–´A,,êµ­ì–´A,,êµ­ì–´A,êµ­ì–´A,êµ­ì–´A,,,êµ­ì–´A,êµ­ì–´A,êµ­ì–´A,,,êµ­ì–´A,,êµ­ì–´A,êµ­ì–´A,,êµ­ì–´A,,êµ­ì–´A,,,
ì¥ìˆ˜ì„,108,105,,,104,,,106,107,,103,,102,,,,104,,107,103,106,,108,,101,,101,,105,102,ì°½ì²´,ì°½ì²´,
16,êµ­ì–´B,êµ­ì–´B,,,êµ­ì–´B,,,êµ­ì–´B,êµ­ì–´B,,êµ­ì–´B,,êµ­ì–´B,,,,êµ­ì–´B,,êµ­ì–´B,êµ­ì–´B,êµ­ì–´B,,êµ­ì–´B,,êµ­ì–´B,,êµ­ì–´B,,êµ­ì–´B,êµ­ì–´B,,,
ì´ìƒìš©,,201,203,,205,204,203,205,202,204,,,,,,203,,201,202,,202,,,205,,,,,204,201,ì°½ì²´,ì°½ì²´,
15,,ë¬¸í•™A,ë¬¸í•™A,,ë¬¸í•™A,ë¬¸í•™A,ë¬¸í•™A,ë¬¸í•™A,ë¬¸í•™A,ë¬¸í•™A,,,,,,ë¬¸í•™A,,ë¬¸í•™A,ë¬¸í•™A,,ë¬¸í•™A,,,ë¬¸í•™A,,,,,ë¬¸í•™A,ë¬¸í•™A,,,
í™ì§„ìˆ™,,206,208,,201,203,202,204,206,205,,,,,,207,,206,208,,206,,,207,,,,,208,207,ì°½ì²´,ì°½ì²´,
15,,ë¬¸í•™A,ë¬¸í•™A,,ë¬¸í•™B,ë¬¸í•™B,ë¬¸í•™B,ë¬¸í•™B,ë¬¸í•™A,ë¬¸í•™B,,,,,,ë¬¸í•™A,,ë¬¸í•™B,ë¬¸í•™A,,ë¬¸í•™A,,,ë¬¸í•™A,,,,,ë¬¸í•™A,ë¬¸í•™A,,,
ì˜¤ì±„ì˜,201,,,201,,,,,,,201,,201,201,201,,201,,,201,,201,201,,201,,201,,207,208,ì°½ì²´,ì°½ì²´,
14,Cì–¸íƒ,,,Aì–¸íƒ,,,,,,,Bì–¸íƒ,,Eì–¸íƒ,Eì–¸íƒ,Bì–¸íƒ,,Aì–¸íƒ,,,Eì–¸íƒ,,Aì–¸íƒ,Cì–¸íƒ,,Bì–¸íƒ,,Cì–¸íƒ,,ë¬¸í•™B,ë¬¸í•™B,,,
ì‹ ì •ì•„,306,,306,,,,,306,,306,306,306,,,306,306,,,,306,,,306,,306,306,306,306,306,,ì°½ì²´,ì°½ì²´,
15,Gí™”ì‘,,Cí™”ì‘,,,,,Jí™”ì‘,,Cí™”ì‘,Hí™”ì‘,IIí™”ì‘,,,Gí™”ì‘,Cí™”ì‘,,,,Gí™”ì‘,,,Jí™”ì‘,,Hí™”ì‘,IIí™”ì‘,Jí™”ì‘,IIí™”ì‘,Hí™”ì‘,,,,
ìš°ë³´ì˜,603,,603,,603,,,,603,,,,,,603,603,,603,,603,,603,,,,,,,,,ì°½ì²´,ì°½ì²´,
9,Gë…ì„œ,,Cê³ ì „,,Aê³ ì „,,,,Aê³ ì „,,,,,,Gë…ì„œ,Cê³ ì „,,Aê³ ì „,,Gë…ì„œ,,Cê³ ì „,,,,,,,,,,,
ê¹€ì—¬ì§„,,,,,,,,603,,,603,603,,,,,,,,,,,603,,603,603,603,603,603,,ì°½ì²´,ì°½ì²´,
9,,,,,,,,Jë…ì„œ,,,Hë…ì„œ,Ië…ì„œ,,,,,,,,,,,Jë…ì„œ,,Hë…ì„œ,Ië…ì„œ,Jë…ì„œ,Ië…ì„œ,Hë…ì„œ,,,,
ë°•ì„±ìš©,,107,108,,106,105,107,,,108,,,106,105,,106,,107,,,105,106,,108,107,,108,105,,,ì°½ì²´,ì°½ì²´,
16,,ìˆ˜í•™A,ìˆ˜í•™A,,ìˆ˜í•™A,ìˆ˜í•™A,ìˆ˜í•™A,,,ìˆ˜í•™A,,,ìˆ˜í•™A,ìˆ˜í•™A,,ìˆ˜í•™A,,ìˆ˜í•™A,,,ìˆ˜í•™A,ìˆ˜í•™A,,ìˆ˜í•™A,ìˆ˜í•™A,,ìˆ˜í•™A,ìˆ˜í•™A,,,,,
ê¹€ì†Œì—°(ìˆ˜),104,,101,,103,102,103,,101,104,,,,,103,102,,,101,,101,104,,102,,103,102,104,,,ì°½ì²´,ì°½ì²´,
16,ìˆ˜í•™B,,ìˆ˜í•™B,,ìˆ˜í•™B,ìˆ˜í•™B,ìˆ˜í•™B,,ìˆ˜í•™B,ìˆ˜í•™B,,,,,ìˆ˜í•™B,ìˆ˜í•™B,,,ìˆ˜í•™B,,ìˆ˜í•™B,ìˆ˜í•™B,,ìˆ˜í•™B,,ìˆ˜í•™B,ìˆ˜í•™B,ìˆ˜í•™B,,,,,
ì „ë¯¸ê²½,,,202,,208,201,,307,201,,,307,,,,,,208,201,,208,,307,202,,307,307,307,,202,ì°½ì²´,ì°½ì²´,
15,,,ëŒ€ìˆ˜A,,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,,Jí™•í†µ,ëŒ€ìˆ˜A,,,Ií™•í†µ,,,,,,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,,ëŒ€ìˆ˜A,,Jí™•í†µ,ëŒ€ìˆ˜A,,Ií™•í†µ,Jí™•í†µ,Ií™•í†µ,,ëŒ€ìˆ˜A,,,
í™ì„ ì˜,,204,207,,206,205,204,207,203,206,,,,,,206,,207,204,,205,,,203,,,,,203,205,ì°½ì²´,ì°½ì²´,
15,,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,,,,,,ëŒ€ìˆ˜A,,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,,ëŒ€ìˆ˜A,,,ëŒ€ìˆ˜A,,,,,ëŒ€ìˆ˜A,ëŒ€ìˆ˜A,,,
ì´ì¶˜ì‹ ,206,602,,206,,,,,,,206,206,602,602,206,,206,,,,,206,206,,206,206,206,206,,,ì°½ì²´,ì°½ì²´,
15,Cê¸°í•˜,Dì¸ìˆ˜,,Aê¸°í•˜,,,,,,,Bê¸°í•˜,Dê¸°í•˜,Dì¸ìˆ˜,Dì¸ìˆ˜,Bê¸°í•˜,,Aê¸°í•˜,,,,,Aê¸°í•˜,Cê¸°í•˜,,Bê¸°í•˜,Dê¸°í•˜,Cê¸°í•˜,Dê¸°í•˜,,,,,
ìœ¤í¬ì˜,,,,,,,208,201,,207,,,,,,,,,,,,,,,,,,,202,203,ì°½ì²´,ì°½ì²´,
5,,,,,,,ëŒ€ìˆ˜B,ëŒ€ìˆ˜B,,ëŒ€ìˆ˜B,,,,,,,,,,,,,,,,,,,ëŒ€ìˆ˜B,ëŒ€ìˆ˜B,,,
ê¹€ë¯¸ê²½(ìˆ˜),,307,307,307,,307,307,,,307,,,307,307,,307,307,,307,,307,307,,307,,,,,,307,ì°½ì²´,ì°½ì²´,
15,,Dí™•í†µ,Cí™•í†µ,Fí™•í†µ,,Eí™•í†µ,Bí™•í†µ,,,Cí™•í†µ,,,Dí™•í†µ,Dí™•í†µ,,Cí™•í†µ,Fí™•í†µ,,Eí™•í†µ,,Eí™•í†µ,Fí™•í†µ,,Bí™•í†µ,,,,,,Bí™•í†µ,,,
ê¹€ì¬ì™„,,306,,306,204,306,,,,,,,306,306,,,306,205,306,,306,306,,206,,,,,,,ì°½ì²´,ì°½ì²´,
12,,Dë¯¸ì ,,Fë¯¸ì ,ëŒ€ìˆ˜B,Eë¯¸ì ,,,,,,,Dë¯¸ì ,Dë¯¸ì ,,,Fë¯¸ì ,ëŒ€ìˆ˜B,Eë¯¸ì ,,Eë¯¸ì ,Fë¯¸ì ,,ëŒ€ìˆ˜B,,,,,,,,,
ì´ëª…ì§„,,,104,106,,,,102,,106,108,,104,102,108,,,104,106,108,,,102,,104,106,,108,102,,ì°½ì²´,ì°½ì²´,
16,,,ì˜ì–´,ì˜ì–´,,,,ì˜ì–´,,ì˜ì–´,ì˜ì–´,,ì˜ì–´,ì˜ì–´,ì˜ì–´,,,ì˜ì–´,ì˜ì–´,ì˜ì–´,,,ì˜ì–´,,ì˜ì–´,ì˜ì–´,,ì˜ì–´,ì˜ì–´,,,,
ê¹€ê¸°ì¬,,,103,105,,,,,207,,,,,101,107,,,103,105,,,,,,,,,107,101,,ì°½ì²´,ì°½ì²´,
9,,,ì˜ì–´,ì˜ì–´,,,,,ì‚¬ì§„,,,,,ì˜ì–´,ì˜ì–´,,,ì˜ì–´,ì˜ì–´,,,,,,,,,ì˜ì–´,ì˜ì–´,,,,
ì´ì¥ìµ,,,,,,,,101,,105,107,,103,,,,,,,107,,,101,,103,105,,,,,ì°½ì²´,ì°½ì²´,
8,,,,,,,,ì˜ì–´,,ì˜ì–´,ì˜ì–´,,ì˜ì–´,,,,,,,ì˜ì–´,,,ì˜ì–´,,ì˜ì–´,ì˜ì–´,,,,,,,
ë¥˜ì¬ì„ ,,,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,,,,ì™¸êµ­ì–´ì‹¤,,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,,,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,,,ì™¸êµ­ì–´ì‹¤,,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,,ì™¸êµ­ì–´ì‹¤,ì™¸êµ­ì–´ì‹¤,,ì°½ì²´,ì°½ì²´,
16,,,ì˜ì–´34,ì˜ì–´56,,,,ì˜ì–´12,,ì˜ì–´56,ì˜ì–´78,,ì˜ì–´34,ì˜ì–´12,ì˜ì–´78,,,ì˜ì–´34,ì˜ì–´56,ì˜ì–´78,,,ì˜ì–´12,,ì˜ì–´34,ì˜ì–´56,,ì˜ì–´78,ì˜ì–´12,,,,
ë°•ì •ì—°,,207,206,,202,208,206,202,208,201,,,,,,208,,202,207,,207,,,201,,,,,201,206,ì°½ì²´,ì°½ì²´,
15,,ì˜ì–´,ì˜ì–´,,ì˜ì–´,ì˜ì–´,ì˜ì–´,ì˜ì–´,ì˜ì–´,ì˜ì–´,,,,,,ì˜ì–´,,ì˜ì–´,ì˜ì–´,,ì˜ì–´,,,ì˜ì–´,,,,,ì˜ì–´,ì˜ì–´,,,
ì‹ ì„¸ì •,,205,,302,203,302,201,,205,203,,,208,208,,204,,203,,208,204,,302,,,,,302,205,204,ì°½ì²´,ì°½ì²´,
17,,ì˜ì–´,,Fì°½ë…,ì˜ì–´,Eì°½ë…,ì—°ê·¹,,ì˜ì–´,ì˜ì–´,,,Eì˜ë¬¸,Eì˜ë¬¸,,ì˜ì–´,,ì˜ì–´,,Eì˜ë¬¸,ì˜ì–´,,Jì°½ë…,,,,,Iì°½ë…,ì˜ì–´,ì˜ì–´,,,
ê¹€ê´‘í›ˆ,,,303,208,303,,303,203,303,303,,208,,,,303,208,303,,,,208,,303,,208,,208,,303,ì°½ì²´,ì°½ì²´,
16,,,Cì˜ë…,Aì˜ë¬¸,Aì˜ë…,,Bì˜ë…,ì—°ê·¹,Aì˜ë…,Cì˜ë…,,Dì˜ë¬¸,,,,Cì˜ë…,Aì˜ë¬¸,Aì˜ë…,,,,Aì˜ë¬¸,,Bì˜ë…,,Dì˜ë¬¸,,Dì˜ë¬¸,,Bì˜ë…,,,
ê¹€ì†Œì—°(ì˜),303,303,,303,,303,,,,,303,,303,303,303,,303,,303,303,303,303,,,303,,,,303,,ì°½ì²´,ì°½ì²´,
15,Gì˜ë…,Dì˜ë…,,Fì˜ë…,,Eì˜ë…,,,,,Hì˜ë…,,Dì˜ë…,Dì˜ë…,Gì˜ë…,,Fì˜ë…,,Eì˜ë…,Gì˜ë…,Eì˜ë…,Fì˜ë…,,,Hì˜ë…,,,,Hì˜ë…,,,,
ë°°ì˜ë¯¸,,,,102,,106,108,107,,,105,104,,106,,101,105,,103,,108,,104,,102,101,103,,107,,ì°½ì²´,ì°½ì²´,
16,,,,êµ­ì‚¬A,,êµ­ì‚¬A,êµ­ì‚¬A,êµ­ì‚¬A,,,êµ­ì‚¬A,êµ­ì‚¬A,,êµ­ì‚¬A,,êµ­ì‚¬A,êµ­ì‚¬A,,êµ­ì‚¬A,,êµ­ì‚¬A,,êµ­ì‚¬A,,êµ­ì‚¬A,êµ­ì‚¬A,êµ­ì‚¬A,,êµ­ì‚¬A,,,,
ê°•í˜„ì•„,208,,106,108,,101,,,104,,208,,,,208,103,,102,,105,107,,208,,208,,208,,,,ì°½ì²´,ì°½ì²´,
14,Cì„¸ì‚¬,,êµ­ì‚¬B,êµ­ì‚¬B,,êµ­ì‚¬B,,,êµ­ì‚¬B,,Bì„¸ì‚¬,,,,Bì„¸ì‚¬,êµ­ì‚¬B,,êµ­ì‚¬B,,êµ­ì‚¬B,êµ­ì‚¬B,,Cì„¸ì‚¬,,Bì„¸ì‚¬,,Cì„¸ì‚¬,,,,,,
ì´í˜„í™”,304,304,,,304,,,,304,,304,,304,304,304,,,304,,304,,108,107,,304,,,106,304,,ì°½ì²´,ì°½ì²´,
15,Gìœ¤ì‚¬,Dìœ¤ì‚¬,,,Aìœ¤ì‚¬,,,,Aìœ¤ì‚¬,,Hìœ¤ì‚¬,,Dìœ¤ì‚¬,Dìœ¤ì‚¬,Gìœ¤ì‚¬,,,Aìœ¤ì‚¬,,Gìœ¤ì‚¬,,í†µì‚¬A,í†µì‚¬A,,Hìœ¤ì‚¬,,,í†µì‚¬A,Hìœ¤ì‚¬,,,,
ë‚˜ìœ ê²½,202,,105,202,,,,103,102,,202,202,,104,202,,202,,,,,202,202,,202,202,202,202,,101,ì°½ì²´,ì°½ì²´,
17,Cí˜„ìœ¤,,í†µì‚¬A,Aí˜„ìœ¤,,,,í†µì‚¬A,í†µì‚¬A,,Bí˜„ìœ¤,Dí˜„ìœ¤,,í†µì‚¬A,Bí˜„ìœ¤,,Aí˜„ìœ¤,,,,,Aí˜„ìœ¤,Cí˜„ìœ¤,,Bí˜„ìœ¤,Dí˜„ìœ¤,Cí˜„ìœ¤,Dí˜„ìœ¤,,í†µì‚¬A,,,
í™ì¸ìˆ™,,,107,,102,601,,601,,101,,105,,,,108,,,601,,601,,601,,106,,601,,104,103,ì°½ì²´,ì°½ì²´,
14,,,í†µì‚¬B,,í†µì‚¬B,Eì—¬ì§€,,Jì—¬ì§€,,í†µì‚¬B,,í†µì‚¬B,,,,í†µì‚¬B,,,Eì—¬ì§€,,Eì—¬ì§€,,Jì—¬ì§€,,í†µì‚¬B,,Jì—¬ì§€,,í†µì‚¬B,í†µì‚¬B,,,
ì „ê·¼ì™„,ì›ë¬µê¿ˆí„°,,,,,603,603,,,,308,201,202,202,,,,,603,202,603\,,,603,308,201,,201,308,603,ì°½ì²´,ì°½ì²´,
16,ììœ¨ì§,,,,,Eë…¼ìˆ ,Bë…¼ìˆ ,,,,Hì„¸ì§€3,Dì„¸ì§€2,Eì„¸ì§€2,Eì„¸ì§€2,,,,,Eë…¼ìˆ ,Eì„¸ì§€2,Eë…¼ìˆ ,,,Bë…¼ìˆ ,Hì„¸ì§€3,Dì„¸ì§€2,,Dì„¸ì§€2,Hì„¸ì§€3,Bë…¼ìˆ ,,,
ì´ì˜ë¯¸,103,101,,,108,,104,,,,305,305,,,,107,,105,,,,102,106,,305,305,,305,305,,ì°½ì²´,ì°½ì²´,
14,í†µì‚¬C,í†µì‚¬C,,,í†µì‚¬C,,í†µì‚¬C,,,,Hì‹¤ê²½,Iì‹¤ê²½,,,,í†µì‚¬C,,í†µì‚¬C,,,,í†µì‚¬C,í†µì‚¬C,,Hì‹¤ê²½,Iì‹¤ê²½,,Iì‹¤ê²½,Hì‹¤ê²½,,,,
ê³µìˆ˜ë¹ˆ,501,,305,,305,,305,,305,305,501,,501,501,501,305,,305,,501,,,501,305,501,,501,,,305,ì°½ì²´,ì°½ì²´,
18,Cë²•ì‚¬,,Cì‚¬íƒ,,Aì‚¬íƒ,,Bì‚¬íƒ,,Aì‚¬íƒ,Cì‚¬íƒ,Bë²•ì‚¬,,Eë²•ì‚¬,Eë²•ì‚¬,Bë²•ì‚¬,Cì‚¬íƒ,,Aì‚¬íƒ,,Eë²•ì‚¬,,,Cë²•ì‚¬,Bì‚¬íƒ,Bë²•ì‚¬,,Cë²•ì‚¬,,,Bì‚¬íƒ,,,
ìµœì€ì˜,,,,305,306,305,205,305,306,208,,,,,,,305,306,305,,305,305,305,,,,305,,,,ì°½ì²´,ì°½ì²´,
14,,,,Fì‚¬íƒ,Aì •ë²•,Eì‚¬íƒ,ì‚¬ì§„,Jì‚¬íƒ,Aì •ë²•,ì‚¬ì§„,,,,,,,Fì‚¬íƒ,Aì •ë²•,Eì‚¬íƒ,,Eì‚¬íƒ,Fì‚¬íƒ,Jì‚¬íƒ,,,,Jì‚¬íƒ,,,,,,
ì´ì€ì§€(ë¬¼),,103,,204,,107,,104,105,,,204,204,204,102,,204,,,204,,204,,101,,204,106,204,,108,ì°½ì²´,ì°½ì²´,
17,,í†µê³¼A,,Aë¬¼ë¦¬,,í†µê³¼A,,í†µê³¼A,í†µê³¼A,,,Dë¬¼ë¦¬,Eë¬¼ë¦¬,Eë¬¼ë¦¬,í†µê³¼A,,Aë¬¼ë¦¬,,,Eë¬¼ë¦¬,,Aë¬¼ë¦¬,,í†µê³¼A,,Dë¬¼ë¦¬,í†µê³¼A,Dë¬¼ë¦¬,,í†µê³¼A,,,
ê¹€ë¯¸ê²½(ë¬¼),301,301,,602,301,,602,,301,,,,301,301,301,,602,301,,301,,602,,602,,,,,,602,ì°½ì²´,ì°½ì²´,
15,Gìƒí™œ,Dìƒí™œ,,Fë¬¼II,Aìƒí™œ,,Bë¬¼II,,Aìƒí™œ,,,,Dìƒí™œ,Dìƒí™œ,Gìƒí™œ,,Fë¬¼II,Aìƒí™œ,,Gìƒí™œ,,Fë¬¼II,,Bë¬¼II,,,,,,Bë¬¼II,,,
ê¹€ìƒìˆ˜,601,,102,103,,104,,,,,601,,108,107,601,,,101,,601,,,105,,601,,,,601,106,ì°½ì²´,ì°½ì²´,
14,Gí™˜ê²½,,í†µê³¼B,í†µê³¼B,,í†µê³¼B,,,,,Hí™˜ê²½,,í†µê³¼B,í†µê³¼B,Gí™˜ê²½,,,í†µê³¼B,,Gí™˜ê²½,,,í†µê³¼B,,Hí™˜ê²½,,,,Hí™˜ê²½,í†µê³¼B,,,
ì‹ ë¯¸ë˜,,,,205,,,,308,,,205,205,205,205,205,,205,,,205,,205,308,,205,205,308,205,,,ì°½ì²´,ì°½ì²´,
15,,,,Aí™”í•™,,,,Jêµìœ¡,,,Bí™”í•™,Dí™”í•™,Eí™”í•™,Eí™”í•™,Bí™”í•™,,Aí™”í•™,,,Eí™”í•™,,Aí™”í•™,Jêµìœ¡,,Bí™”í•™,Dí™”í•™,Jêµìœ¡,Dí™”í•™,,,,,
ì´ì§„ì•„,308,308,,,308,,,602,308,,,602,308,308,308,,,308,,308,,,602,,,602,602,602,,,ì°½ì²´,ì°½ì²´,
15,Gêµìœ¡,Dêµìœ¡,,,Aêµìœ¡,,,Jí™”II,Aêµìœ¡,,,Ií™”II,Dêµìœ¡,Dêµìœ¡,Gêµìœ¡,,,Aêµìœ¡,,Gêµìœ¡,,,Jí™”II,,,Ií™”II,Jí™”II,Ií™”II,,,,,
ì´ì¬ì—°,105,,,,602,,,206,602,202,602,,,,,,,602,,106,,,,103,602,,,,602,104,ì°½ì²´,ì°½ì²´,
12,í†µê³¼C,,,,AìƒII,,,ì‚¬ì§„,AìƒII,ì—°ê·¹,HìƒII,,,,,,,AìƒII,,í†µê³¼C,,,,í†µê³¼C,HìƒII,,,,HìƒII,í†µê³¼C,,,
ëª©ì •ë¯¼,,,,,,,101,108,,102,,107,,,,,,,,,,,,,,,,,,,ì°½ì²´,ì°½ì²´,
4,,,,,,,í†µê³¼C,í†µê³¼C,,í†µê³¼C,,í†µê³¼C,,,,,,,,,,,,,,,,,,,,,
ì„ìˆ˜ì§„,207,,,207,,,,,,,301,301,207,207,,,207,,,207,,207,207,,301,301,207,301,301,,ì°½ì²´,ì°½ì²´,
15,Cìƒëª…,,,Aìƒëª…,,,,,,,Hìƒí™œ,Iìƒí™œ,Eìƒëª…,Eìƒëª…,,,Aìƒëª…,,,Eìƒëª…,,Aìƒëª…,Cìƒëª…,,Hìƒí™œ,Iìƒí™œ,Cìƒëª…,Iìƒí™œ,Hìƒí™œ,,,,
ì´ì€ì§€(ì§€),205,102,,101,,108,,,204,,,106,206,206,,,107,,104,206,,103,205,,105,,205,,,,ì°½ì²´,ì°½ì²´,
15,Cì§€êµ¬,ê³¼ì‹¤,,ê³¼ì‹¤,,ê³¼ì‹¤,,,ì—°ê·¹,,,ê³¼ì‹¤,Eì§€êµ¬,Eì§€êµ¬,,,ê³¼ì‹¤,,ê³¼ì‹¤,Eì§€êµ¬,,ê³¼ì‹¤,Cì§€êµ¬,,ê³¼ì‹¤,,Cì§€êµ¬,,,,,,
ê¹€ì •ìˆœ,602,,601,601,,,601,,,601,,601,,,602,601,601,,,602,,601,,601,,601,,601,,601,ì°½ì²´,ì°½ì²´,
15,Gì§€II,,Cí™˜ê²½,Fí™˜ê²½,,,Bí™˜ê²½,,,Cí™˜ê²½,,Ií™˜ê²½,,,Gì§€II,Cí™˜ê²½,Fí™˜ê²½,,,Gì§€II,,Fí™˜ê²½,,Bí™˜ê²½,,Ií™˜ê²½,,Ií™˜ê²½,,Bí™˜ê²½,,,
ì¡°ì˜ê¸€,,305,ì›ë¬µê¿ˆí„°,,101,,304,302,,,,302,305,305,,,102,,,,102,101,,304,,302,302,,,304,ì°½ì²´,ì°½ì²´,
15,,Dì²´ê¸°,ì²´ìœ¡ì§,,ì²´ìœ¡,,Bì²´ì‹¬,Jìš´ê±´,,,,Iìš´ê±´,Dì²´ê¸°,Dì²´ê¸°,,,ì²´ìœ¡,,,,ì²´ìœ¡,ì²´ìœ¡,,Bì²´ì‹¬,,Iìš´ê±´,Jìš´ê±´,,,Bì²´ì‹¬,,,
ì „í¬ì² ,,,,,,,,,,302,,103,302,302,,302,103,,,,,,,,,,,,,,ì°½ì²´,ì°½ì²´,
6,,,,,,,,,,Cìš´ê±´,,ì²´ìœ¡,Dìš´ê±´,Dìš´ê±´,,Cìš´ê±´,ì²´ìœ¡,,,,,,,,,,,,,,,,
ìœ ìŠ¹í˜„,106,ì›ë¬µê¿ˆí„°,,107,,,,,106,,104,,105,108,,,302,,302,,302,302,,104,,107,105,,108,,ì°½ì²´,ì°½ì²´,
15,ì²´ìœ¡,ì²´ìœ¡ì§,,ì²´ìœ¡,,,,,ì²´ìœ¡,,ì²´ìœ¡,,ì²´ìœ¡,ì²´ìœ¡,,,Fìš´ê±´,,Eìš´ê±´,,Eìš´ê±´,Fìš´ê±´,,ì²´ìœ¡,,ì²´ìœ¡,ì²´ìœ¡,,ì²´ìœ¡,,,,
ê¹€í™”ì„­,,202,204,,,207,302,,302,,207,,,,207,201,,302,205,,203,,,208,207,,,,206,302,ì°½ì²´,ì°½ì²´,
15,,ìŠ¤ê³¼,ìŠ¤ê³¼,,,ìŠ¤ê³¼,Bìš´ê±´,,Aìš´ê±´,,Bê¸°ì²´,,,,Bê¸°ì²´,ìŠ¤ê³¼,,Aìš´ê±´,ìŠ¤ê³¼,,ìŠ¤ê³¼,,,ìŠ¤ê³¼,Bê¸°ì²´,,,,ìŠ¤ê³¼,Bìš´ê±´,,,
ì„œì—°ì •,101,104,,,307,103,,304,307,,,102,101,,,104,,307,,102,104,,304,302,,,304,103,,,ì°½ì²´,ì°½ì²´,
16,ìŒì•…,ìŒì•…,,,Aì‹œì²­,ìŒì•…,,JìŒì´,Aì‹œì²­,,,ìŒì•…,ìŒì•…,,,ìŒì•…,,Aì‹œì²­,,ìŒì•…,ìŒì•…,,JìŒì´,Bì°½ë…,,,JìŒì´,ìŒì•…,,,,,
êµ¬ìí–¥,102,208,205,,207,206,207,208,,103,,,,,,205,101,,206,,,,,,,,,,,,ì°½ì²´,ì°½ì²´,
11,ìŒì•…,ìŒì—°,ìŒì—°,,ìŒì—°,ìŒì—°,ìŒì—°,ìŒì—°,,ìŒì•…,,,,,,ìŒì—°,ìŒì•…,,ìŒì—°,,,,,,,,,,,,,,
ì´í˜¸ìˆœ,,,302,,107,308,105,,,107,,108,,,106,105,,108,308,,308,107,,106,,108,,,106,105,ì°½ì²´,ì°½ì²´,
16,,,Cì°½ë…,,ë¯¸ìˆ ,Eí‰ì¡°,ë¯¸ìˆ ,,,ë¯¸ìˆ ,,ë¯¸ìˆ ,,,ë¯¸ìˆ ,ë¯¸ìˆ ,,ë¯¸ìˆ ,Eí‰ì¡°,,Eí‰ì¡°,ë¯¸ìˆ ,,ë¯¸ìˆ ,,ë¯¸ìˆ ,,,ë¯¸ìˆ ,ë¯¸ìˆ ,,,
ì •ìˆ˜ì¼,,203,201,308,,202,,,,,,,,,,202,308,204,203,,201,308,,204,,,,,,,ì°½ì²´,ì°½ì²´,
11,,ë¯¸ì°½,ë¯¸ì°½,Fë¯¸ì‹¤,,ë¯¸ì°½,,,,,,,,,,ë¯¸ì°½,Fë¯¸ì‹¤,ë¯¸ì°½,ë¯¸ì°½,,ë¯¸ì°½,Fë¯¸ì‹¤,,ë¯¸ì°½,,,,,,,,,
ë¥˜ì§€ì˜ˆ,107,108,,,105,,102,,103,,106,101,,,104,,106,,108,,103,105,,107,,102,104,101,,,ì°½ì²´,ì°½ì²´,
16,í”„ë¡œ,í”„ë¡œ,,,í”„ë¡œ,,í”„ë¡œ,,í”„ë¡œ,,í”„ë¡œ,í”„ë¡œ,,,í”„ë¡œ,,í”„ë¡œ,,í”„ë¡œ,,í”„ë¡œ,í”„ë¡œ,,í”„ë¡œ,,í”„ë¡œ,í”„ë¡œ,í”„ë¡œ,,,,,
ê¹€íƒœí¬,204,302,,304,302,,,,,,204,,203,203,204,,304,,,203,,304,204,,204,,204,,,,ì°½ì²´,ì°½ì²´,
14,Cì¸ì§€2,Dì°½ë…,,Fì¸ì§€3,Aì°½ë…,,,,,,Bì¸ì§€2,,Eì¸ì§€2,Eì¸ì§€2,Bì¸ì§€2,,Fì¸ì§€3,,,Eì¸ì§€2,,Fì¸ì§€3,Cì¸ì§€2,,Bì¸ì§€2,,Cì¸ì§€2,,,,,,
ìµœì„ ì„,203,,301,203,,301,,,,301,203,203,,,203,301,203,,301,,301,,,,,,203,203,,,ì°½ì²´,ì°½ì²´,
18,Cì¼I,,Cì¼Ii,Aì¼I,,Eì¼II,,,,Cì¼Ii,Bì¼I,Dì¼I,,,Bì¼I,Cì¼Ii,Aì¼I,,Eì¼II,,Eì¼II,,,,,,Cì¼I,Dì¼I,,,,,
ì¥ìŠ¹ë´‰,,,,,,,,,,,,,,,,,,,,,,203,203,,203,203,,,,,ì°½ì²´,ì°½ì²´,
4,,,,,,,,,,,,,,,,,,,,,,Aì¼I,Cì¼I,,Bì¼I,Dì¼I,,,,,,,
ë°•ì„ ì˜,,,,,,,306,,,,,207,,,,,,,,,,,,306,,207,,207,,306,ì°½ì²´,ì°½ì²´,
6,,,,,,,Bì¤‘II,,,,,Dì¤‘I,,,,,,,,,,,,Bì¤‘II,,Dì¤‘I,,Dì¤‘I,,Bì¤‘II,,,
ë¬¸ë¯¸ì„ ,,,,ì›ë¬µê¿ˆí„°,ì›ë¬µê¿ˆí„°,ì›ë¬µê¿ˆí„°,106,,,,102,,,,101,,108,,,104,,,,105,,,107,,103,,ì°½ì²´,ì°½ì²´,
11,,,,ì§„ë¡œì§,ë™ì•„ì§,ë™ì•„ì§,ì§„ë¡œ,,,,ì§„ë¡œ,,,,ì§„ë¡œ,,ì§„ë¡œ,,,ì§„ë¡œ,,,,ì§„ë¡œ,,,ì§„ë¡œ,,ì§„ë¡œ,,,,
ì „ì„±ì§„,,,,,,,205,206,207,208,,,,,,,,,,,,,,,,,,,,,ì°½ì²´,ì°½ì²´,
4,,,,,,,ì‚¬ì§„,ì‚¬ì§„,ì‚¬ì§„,ì‚¬ì§„,,,,,,,,,,,,,,,,,,,,,,,
ë¯¼ì„ í•´,,,,,,,201,203,204,202,,,,,,,,,,,,,,,,,,,,,ì°½ì²´,ì°½ì²´,
4,,,,,,,ì—°ê·¹,ì—°ê·¹,ì—°ê·¹,ì—°ê·¹,,,,,,,,,,,,,,,,,,,,,,,
ê°€ìƒ31,,,,301,,,301,301,,,,,,,,,301,,,,,301,301,301,,,301,,,301,ì°½ì²´,ì°½ì²´,
9,,,,Fê³µì‹¤,,,Bê³µì‹¤,Jê³µì‹¤,,,,,,,,,Fê³µì‹¤,,,,,Fê³µì‹¤,Jê³µì‹¤,Bê³µì‹¤,,,Jê³µì‹¤,,,Bê³µì‹¤,,,
ê°€ìƒ32,302,,,,,,,,,,302,,,,302,,,,,302,,,,,302,,,,302,,ì°½ì²´,ì°½ì²´,
6,Gê³µì‹¤,,,,,,,,,,Hê³µì‹¤,,,,Gê³µì‹¤,,,,,Gê³µì‹¤,,,,,Hê³µì‹¤,,,,Hê³µì‹¤,,,,
ê°€ìƒ33,,,,,,,,303,,,,303,,,,,,,,,,,303,,,303,303,303,,,ì°½ì²´,ì°½ì²´,
6,,,,,,,,Jê³µì‹¤,,,,Iê³µì‹¤,,,,,,,,,,,Jê³µì‹¤,,,Iê³µì‹¤,Jê³µì‹¤,Iê³µì‹¤,,,,,
ê°€ìƒ34,,,304,,,304,,,,304,,304,,,,304,,,304,,304,,,,,304,,304,,,ì°½ì²´,ì°½ì²´,
9,,,Cê³µì‹¤,,,Eê³µì‹¤,,,,Cê³µì‹¤,,Iê³µì‹¤,,,,Cê³µì‹¤,,,Eê³µì‹¤,,Eê³µì‹¤,,,,,Iê³µì‹¤,,Iê³µì‹¤,,,,,
ê°€ìƒ35,305,,,,,,,,,,,,,,305,,,,,305,,,,,,,,,,,ì°½ì²´,ì°½ì²´,
3,Gê³µì‹¤,,,,,,,,,,,,,,Gê³µì‹¤,,,,,Gê³µì‹¤,,,,,,,,,,,,,
ê°€ìƒ37,307,,,,,,,,,,307,,,,307,,,,,307,,,,,307,,,,307,,ì°½ì²´,ì°½ì²´,
-6,Gê³µì‹¤,,,,,,,,,,Hê³µì‹¤,,,,Gê³µì‹¤,,,,,Gê³µì‹¤,,,,,Hê³µì‹¤,,,,Hê³µì‹¤,,,,
ê°€ìƒ38,,,308,,,,308,,,308,,308,,,,308,,,,,,,,308,,308,,308,,308,ì°½ì²´,ì°½ì²´,
9,,,Cê³µì‹¤,,,,Bê³µì‹¤,,,Cê³µì‹¤,,Iê³µì‹¤,,,,Cê³µì‹¤,,,,,,,,Bê³µì‹¤,,Iê³µì‹¤,,Iê³µì‹¤,,Bê³µì‹¤,,,
`;

const semester2Csv = `ìš”ì¼,ì›”,,,,,,í™”,,,,,,,ìˆ˜,,,,,,ëª©,,,,,,,ê¸ˆ,,,,,
êµì‚¬ëª…/êµì‹œ,1,2,3,4,5,6,1,2,3,4,5,6,7,1,2,3,4,5,6,1,2,3,4,5,6,7,1,2,3,4,5,6

`;

const semester3Csv = `ìš”ì¼,ì›”,,,,,,í™”,,,,,,,ìˆ˜,,,,ëª©,,,,,,,ê¸ˆ,,,,,
êµì‚¬ëª…/êµì‹œ,1,2,3,4,5,6,1,2,3,4,5,6,7,1,2,3,4,1,2,3,4,5,6,7,1,2,3,4,5,6

`;

const studentCsvGrade1 = `í•™ë²ˆ,ì´ë¦„
10101,ê¹€ë¯¼ìˆ˜

`;

const studentCsvAllGrade2 = `í•™ë²ˆ,ì´ë¦„
20101,ê°•ìˆ˜ì •

`;

const studentCsvGrade2 = `í•™ë²ˆ,ì´ë¦„,ì‹¬í™” êµ­ì–´,ê¸°í•˜,ì˜ì–´ê¶Œ ë¬¸í™”,í•œêµ­ì§€ë¦¬,ì„¸ê³„ì‚¬,ì‚¬íšŒï½¥ë¬¸í™”,ìƒí™œê³¼ ìœ¤ë¦¬,ë¬¼ë¦¬í•™â… ,í™”í•™â… ,ìƒëª…ê³¼í•™â… ,ì§€êµ¬ê³¼í•™â… ,ì²´ìœ¡ íƒêµ¬,ìŒì•… ì—°ì£¼,ë¯¸ìˆ  ê°ìƒê³¼ ë¹„í‰,ì¼ë³¸ì–´â… ,ì¤‘êµ­ì–´â… 
20101,ê°•ìˆ˜ì •,,E,,,,,,B,A,,C,,,,D,

`;

const studentCsvGrade3 = `í•™ë²ˆ,ì´ë¦„,ì˜ì–´ ë…í•´ì™€ ì‘ë¬¸,ìš´ë™ê³¼ ê±´ê°•,í™”ë²•ê³¼ ì‘ë¬¸,ë…ì„œ,ê³ ì „ ì½ê¸°,í™•ë¥ ê³¼ í†µê³„,ë¯¸ì ë¶„,ì¸ê³µì§€ëŠ¥ ìˆ˜í•™,ì„¸ê³„ì§€ë¦¬,ë™ì•„ì‹œì•„ì‚¬,ì •ì¹˜ì™€ ë²•,ìœ¤ë¦¬ì™€ ì‚¬ìƒ,ì—¬í–‰ì§€ë¦¬,ì‚¬íšŒë¬¸ì œ íƒêµ¬,ê³ ì „ê³¼ ìœ¤ë¦¬,ë¬¼ë¦¬í•™â…¡,í™”í•™â…¡,ìƒëª…ê³¼í•™â…¡,ì§€êµ¬ê³¼í•™â…¡,ê³¼í•™ì‚¬,ìƒí™œê³¼ ê³¼í•™,ì²´ìœ¡ ì „ê³µ ì‹¤ê¸° ì‹¬í™”,ì²´ìœ¡ ì „ê³µ ì‹¤ê¸° ê¸°ì´ˆ,ìŒì•… ì´ë¡ ,ì‹œì°½Â·ì²­ìŒ,í‰ë©´ ì¡°í˜•,ë¯¸ìˆ  ì „ê³µ ì‹¤ê¸°,ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ,ì¼ë³¸ì–´â…¡,ì¤‘êµ­ì–´â…¡,êµìœ¡í•™,í™˜ê²½,ì‹¤ìš© ê²½ì œ,ë…¼ìˆ ,ì°½ë…
30101,ê¹€ë„ìœ¤,C,G,I,,,F,,,,,,,J,,,,,,H,A,E,,,,,,,,,,B,D,,,G

`;

const studentCsvGrade3Names = `í•™ë²ˆ,ì´ë¦„
30101,ê¹€ë„ìœ¤

`;

        // --- End of Data Section ---

        // --- React Hooks and Data Maps ---
        const SUBJECT_CODE_MAP = {
            'ì‹¬êµ­': 'ì‹¬í™” êµ­ì–´', 'ê¸°í•˜': 'ê¸°í•˜', 'ì˜ë¬¸': 'ì˜ì–´ê¶Œ ë¬¸í™”', 'í•œì§€': 'í•œêµ­ì§€ë¦¬', 'ì„¸ì‚¬': 'ì„¸ê³„ì‚¬', 'ì‚¬ë¬¸': 'ì‚¬íšŒï½¥ë¬¸í™”', 'ìƒìœ¤': 'ìƒí™œê³¼ ìœ¤ë¦¬', 'ë¬¼â… ': 'ë¬¼ë¦¬í•™â… ', 'í™”â… ': 'í™”í•™â… ', 'ìƒâ… ': 'ìƒëª…ê³¼í•™â… ', 'ì§€â… ': 'ì§€êµ¬ê³¼í•™â… ', 'ì²´íƒ': 'ì²´ìœ¡ íƒêµ¬', 'ìŒì—°': 'ìŒì•… ì—°ì£¼', 'ë¯¸ê°': 'ë¯¸ìˆ  ê°ìƒê³¼ ë¹„í‰', 'ì¼â… ': 'ì¼ë³¸ì–´â… ', 'ì¤‘â… ': 'ì¤‘êµ­ì–´â… ', 'ì˜ë…': 'ì˜ì–´ ë…í•´ì™€ ì‘ë¬¸', 'ìš´ê±´': 'ìš´ë™ê³¼ ê±´ê°•', 'í™”ì‘': 'í™”ë²•ê³¼ ì‘ë¬¸', 'ë…ì„œ': 'ë…ì„œ', 'ê³ ì „': 'ê³ ì „ ì½ê¸°', 'í™•í†µ': 'í™•ë¥ ê³¼ í†µê³„', 'ë¯¸ì ': 'ë¯¸ì ë¶„', 'ì¸ìˆ˜': 'ì¸ê³µì§€ëŠ¥ ìˆ˜í•™', 'ì„¸ì§€': 'ì„¸ê³„ì§€ë¦¬', 'ë™ì‚¬': 'ë™ì•„ì‹œì•„ì‚¬', 'ì •ë²•': 'ì •ì¹˜ì™€ ë²•', 'ìœ¤ì‚¬': 'ìœ¤ë¦¬ì™€ ì‚¬ìƒ', 'ì—¬ì§€': 'ì—¬í–‰ì§€ë¦¬', 'ì‚¬íƒ': 'ì‚¬íšŒë¬¸ì œ íƒêµ¬', 'ê³ ìœ¤': 'ê³ ì „ê³¼ ìœ¤ë¦¬', 'ë¬¼â…¡': 'ë¬¼ë¦¬í•™â…¡', 'í™”â…¡': 'í™”í•™â…¡', 'ìƒâ…¡': 'ìƒëª…ê³¼í•™â…¡', 'ì§€â…¡': 'ì§€êµ¬ê³¼í•™â…¡', 'ê³¼ì‚¬': 'ê³¼í•™ì‚¬', 'ìƒí™œ': 'ìƒí™œê³¼ ê³¼í•™', 'ì²´ê¸°': 'ì²´ìœ¡ ì „ê³µ ì‹¤ê¸° ê¸°ì´ˆ', 'ì²´ì‹¬': 'ì²´ìœ¡ ì „ê³µ ì‹¤ê¸° ì‹¬í™”', 'ìŒì´': 'ìŒì•… ì´ë¡ ', 'ì‹œì²­': 'ì‹œì°½Â·ì²­ìŒ', 'í‰ì¡°': 'í‰ë©´ ì¡°í˜•', 'ë¯¸ì‹¤': 'ë¯¸ìˆ  ì „ê³µ ì‹¤ê¸°', 'ì¸ì§€': 'ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ', 'ì¼â…¡': 'ì¼ë³¸ì–´â…¡', 'ì¤‘â…¡': 'ì¤‘êµ­ì–´â…¡', 'êµìœ¡': 'êµìœ¡í•™', 'í™˜ê²½': 'í™˜ê²½', 'ì‹¤ê²½': 'ì‹¤ìš© ê²½ì œ', 'ë…¼ìˆ ': 'ë…¼ìˆ ', 'ì°½ë…': 'ì°½ë…'
        };
        
        // --- Helper Functions ---
        const parseTimetableCSV = (csvText, isGrade3 = false) => {
            return new Promise((resolve, reject) => {
                try {
                    if (!csvText) return resolve({ records: [], teachers: [], classes: [], teacherHours: {} });
                    const rows = csvText.trim().split('\n').map(row => row.split(',').map(cell => cell.trim()));
                    if (rows.length < 2) reject(new Error('CSV file is too short.'));
                    
                    const headers = [];
                    let currentDayLabel = '';
                    const dayRow = rows[0];
                    const periodRow = rows[1];
                    for (let i = 1; i < periodRow.length; i++) {
                        if (dayRow[i]) currentDayLabel = dayRow[i];
                        headers.push({ day: currentDayLabel, period: periodRow[i] ? parseInt(periodRow[i], 10) : 0 });
                    }
                    
                    const records = [], teachers = new Set(), classes = new Set(), teacherHours = {};
                    
                    if (isGrade3) {
                         // ê³ 3 ë°ì´í„°ëŠ” êµì‚¬ë³„ë¡œ í•œ ì¤„ì”© ìˆìŒ. ê³¼ëª© ì •ë³´ ì—†ìŒ.
                        for (let i = 2; i < rows.length; i++) {
                            const teacherRow = rows[i];
                            if (!teacherRow || !teacherRow[0]) continue;
                            const teacherName = teacherRow[0];
                            teachers.add(teacherName);
                            for (let j = 1; j < teacherRow.length; j++) {
                                const classId = teacherRow[j];
                                // ê³ 3ì€ ê³¼ëª©ëª…ì´ ë³„ë„ë¡œ ì—†ìœ¼ë¯€ë¡œ, í•™ê¸‰ ì •ë³´ë§Œ ì‚¬ìš©.
                                const subject = classId; 
                                const header = headers[j - 1];
                                if (classId && subject && header && header.period) {
                                    records.push({ teacher: teacherName, classId, subject, day: header.day, period: header.period });
                                    if(classId !== 'ì°½ì²´' && classId !== 'ì§ì—…') classes.add(classId);
                                }
                            }
                        }
                    } else {
                        // 1, 2í•™ë…„ ë°ì´í„°ëŠ” êµì‚¬ ì •ë³´ì™€ ê³¼ëª© ì •ë³´ê°€ 2ì¤„ì”© ìŒìœ¼ë¡œ ìˆìŒ.
                        for (let i = 2; i < rows.length; i += 2) {
                            const teacherRow = rows[i];
                            const subjectRow = rows[i + 1];
                            if (!teacherRow || !teacherRow[0] || !subjectRow) continue;
                            
                            const teacherName = teacherRow[0];
                            teachers.add(teacherName);
                            teacherHours[teacherName] = parseInt(subjectRow[0] || '0', 10) || 0;
                            
                            for (let j = 1; j < teacherRow.length; j++) {
                                const classId = teacherRow[j];
                                let subject = subjectRow[j];
                                const header = headers[j - 1];
                                if (classId && classId.includes('ì°½ì²´') && !subject) subject = classId;
                                if (classId && subject && header && header.period) {
                                    records.push({ teacher: teacherName, classId, subject, day: header.day, period: header.period });
                                     if(classId !== 'ì°½ì²´') classes.add(classId);
                                }
                            }
                        }
                    }
                    
                    resolve({
                        records,
                        teachers: Array.from(teachers).sort(),
                        classes: Array.from(classes).sort((a, b) => a.localeCompare(b, undefined, { numeric: true })),
                        teacherHours,
                    });
                } catch (error) { reject(error); }
            });
        };
        
        const parseStudentCSV = (csvText) => {
            try {
                if (!csvText) return { headers: [], data: [] };
                const rows = csvText.trim().split('\n').map(r => r.split(','));
                const headers = rows[0].map(h => h.trim());
                const data = [];
                for (let i = 1; i < rows.length; i++) {
                    const student = {};
                    const row = rows[i].map(cell => cell.trim());
                    if (row.length < 2 || !row[0] || !row[1]) continue;
                    headers.forEach((header, j) => {
                        if (header) student[header] = row[j] || null;
                    });
                    data.push(student);
                }
                return { headers: headers.slice(2), data };
            } catch (error) {
                console.error("Error parsing student CSV:", error);
                return { headers: [], data: [] };
            }
        };

        // --- Components ---
        const HomeScreen = ({ onSemesterSelect, onStudentSearchSelect, isLoading, error }) => {
            return (
                <div className="bg-white p-8 rounded-lg shadow-2xl max-w-2xl mx-auto text-center">
                    <header className="mb-8">
                        <svg xmlns="http://www.w3.org/2000/svg" className="mx-auto h-24 w-24 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={1.5}><path strokeLinecap="round" strokeLinejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /><path strokeLinecap="round" strokeLinejoin="round" d="M9 14h.01M12 14h.01M15 14h.01M9 17h.01M12 17h.01M15 17h.01" /></svg>
                        <h1 className="text-4xl font-bold text-gray-800 mt-4">ì›ë¬µê³ ë“±í•™êµ ì‹œê°„í‘œ ì‹œìŠ¤í…œ</h1>
                        <p className="text-xl text-gray-600 mt-2">2026í•™ë…„ë„</p>
                    </header>
                    <main className="space-y-4">
                        <p className="text-lg text-gray-700">ì›í•˜ëŠ” ë©”ë‰´ë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <button onClick={() => onSemesterSelect('1')} disabled={isLoading} className="w-full px-8 py-4 text-xl font-bold text-white bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all disabled:bg-gray-400">{isLoading ? 'ë¡œë”© ì¤‘...' : '1í•™ê¸° ì‹œê°„í‘œ'}</button>
                            <button onClick={() => onSemesterSelect('2')} disabled={isLoading} className="w-full px-8 py-4 text-xl font-bold text-white bg-gradient-to-r from-green-500 to-green-600 rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all disabled:bg-gray-400">{isLoading ? 'ë¡œë”© ì¤‘...' : '2í•™ê¸° ì‹œê°„í‘œ'}</button>
                            <button onClick={() => onSemesterSelect('3')} disabled={isLoading} className="w-full px-8 py-4 text-xl font-bold text-white bg-gradient-to-r from-red-500 to-red-600 rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all disabled:bg-gray-400">{isLoading ? 'ë¡œë”© ì¤‘...' : 'ê³ 3 ì‹œê°„í‘œ'}</button>
                            <button onClick={onStudentSearchSelect} disabled={isLoading} className="w-full px-8 py-4 text-xl font-bold text-white bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all disabled:bg-gray-400">{isLoading ? 'ë¡œë”© ì¤‘...' : 'ê°œì¸ë³„/ë°˜ë³„ ì„ íƒê³¼ëª© í™•ì¸'}</button>
                        </div>
                        {error && <p className="text-red-500 text-sm mt-4">{error}</p>}
                    </main>
                </div>
            );
        };
        
        const StudentListModal = ({ modalData, onClose, onStudentClick }) => {
            if (!modalData) return null;
            const { subject, students, isElective, teacher } = modalData;

            const handleRowClick = (student) => {
                if (isElective) {
                    onStudentClick(student);
                }
            };

            return (
                <div className="no-print fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50" onClick={onClose}>
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[80vh] flex flex-col" onClick={(e) => e.stopPropagation()}>
                        <header className="p-5 border-b border-gray-200 text-center">
                            <h2 className="text-2xl font-bold text-gray-800">{subject}</h2>
                             {teacher && <p className="text-lg text-gray-700 font-semibold mt-2">ë‹´ë‹¹êµì‚¬: {teacher}</p>}
                            <p className="text-base text-gray-600 mt-1">ì´ {students.length}ëª…</p>
                        </header>
                        <main className="p-6 overflow-y-auto">
                            <table className="w-full text-left">
                                <thead className="text-lg text-gray-700"><tr><th className="w-16 px-4 py-2">ìˆœ</th><th className="px-4 py-2">í•™ë²ˆ</th><th className="px-4 py-2">ì´ë¦„</th></tr></thead>
                                <tbody>
                                    {students.map((student, index) => (
                                        <tr key={index} className={`border-t ${isElective ? 'cursor-pointer hover:bg-blue-100' : ''}`} onClick={() => handleRowClick(student)}>
                                            <td className="px-4 py-2">{index + 1}</td><td className="px-4 py-2">{student.id}</td><td className="px-4 py-2">{student.name}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </main>
                        <footer className="p-4 bg-gray-50 border-t border-gray-200 text-right">
                             <button onClick={onClose} className="px-6 py-2 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600">ë‹«ê¸°</button>
                        </footer>
                    </div>
                </div>
            );
        };

        const StudentDetailModal = ({ modalData, onClose }) => {
            if (!modalData) return null;
            const { name, subjects } = modalData;
            return (
                <div className="no-print fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50" onClick={onClose}>
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-md" onClick={(e) => e.stopPropagation()}>
                        <header className="p-5 border-b"><h2 className="text-xl font-bold text-center">{name} í•™ìƒ ì„ íƒê³¼ëª© í˜„í™©</h2></header>
                        <main className="p-6 max-h-[60vh] overflow-y-auto">
                             <ul className="space-y-2">
                                {subjects.length > 0 ? subjects.map((subject, index) => (<li key={index} className="px-4 py-2 bg-gray-100 rounded-md text-gray-800">{subject}</li>)) : <p className="text-center text-gray-500">ì„ íƒí•œ ê³¼ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>}
                            </ul>
                        </main>
                        <footer className="p-4 bg-gray-50 text-right rounded-b-xl">
                            <button onClick={onClose} className="px-5 py-2 bg-gray-500 text-white font-semibold rounded-lg shadow-md hover:bg-gray-600">ë‹«ê¸°</button>
                        </footer>
                    </div>
                </div>
            );
        };

        const TimetableView = ({ gridData, days, onCellClick }) => {
            return (
                <div className="overflow-x-auto shadow-2xl rounded-lg border border-gray-300">
                    <table className="w-full border-collapse text-center table-fixed">
                        <thead>
                            <tr>
                                <th className="p-2 md:p-4 border-b-2 border-r border-gray-400 bg-[#666666] text-white font-bold text-lg md:text-2xl shadow-md">êµì‹œ</th>
                                {days.map(day => (<th key={day} className="p-2 md:p-4 border-b-2 border-r border-gray-400 bg-[#3c78d8] text-white font-bold text-lg md:text-2xl shadow-md">{day}</th>))}
                            </tr>
                        </thead>
                        <tbody>
                            {gridData.map((row, periodIndex) => (
                                <tr key={periodIndex} className={`h-16 md:h-20 ${periodIndex === 3 ? 'border-b-2 border-orange-500' : 'border-b border-gray-200'}`}>
                                    <td className="p-1 border-r border-gray-200 bg-gray-100 text-gray-800 font-bold text-xl md:text-2xl shadow-inner">{periodIndex + 1}</td>
                                    {row.map((cell, dayIndex) => {
                                        const isCreativeActivity = cell?.topText === 'ì°½ì²´';
                                        const is7thPeriodEmptySlot = !cell && periodIndex === 6 && [0, 2, 4].includes(dayIndex);
                                        const cellBgColor = is7thPeriodEmptySlot ? 'bg-gray-100' : 'bg-white';
                                        const isSelectable = cell && !isCreativeActivity;
                                        return (
                                            <td key={`${periodIndex}-${dayIndex}`} className={`p-1 border-r border-gray-200 ${cellBgColor} overflow-hidden text-ellipsis transition-all duration-200 ease-in-out ${isSelectable ? 'hover:shadow-lg hover:bg-yellow-50 hover:scale-105 transform cursor-pointer' : ''}`} style={{boxShadow: 'inset 2px 2px 5px rgba(0,0,0,0.05)'}} onClick={() => isSelectable && onCellClick(cell)}>
                                                {cell ? (isCreativeActivity ? (
                                                    <div className="flex flex-col justify-center items-center h-full"><span className="font-bold text-black dynamic-text-large">{cell.topText}</span></div>
                                                ) : (
                                                    <div className="flex flex-col justify-center items-center h-full"><span className="font-bold text-black dynamic-text-large">{cell.topText}</span><span className="text-blue-600 mt-1 dynamic-text-small">{cell.bottomText}</span></div>
                                                )) : (<span></span>)}
                                            </td>
                                        );
                                    })}
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            );
        };
        
        const TimetableScreen = ({ schoolInfo, parsedData, onReset, onCellClick, onPrint }) => {
            const DAYS_OF_WEEK = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const [viewMode, setViewMode] = useState('teacher');
            const [selectedTeacher, setSelectedTeacher] = useState('');
            const [selectedClass, setSelectedClass] = useState('');
            const isGrade3 = schoolInfo.semester === 'ê³ 3';
        
            useEffect(() => {
                const realTeachers = parsedData.teachers.filter(t => !t.includes('ê°€ìƒ'));
                if (realTeachers.length > 0) setSelectedTeacher(realTeachers[0]);
                else if (parsedData.teachers.length > 0) setSelectedTeacher(parsedData.teachers[0]);

                if (parsedData.classes.length > 0) setSelectedClass(parsedData.classes[0]);
            }, [parsedData]);
        
            const gridData = useMemo(() => {
                const grid = Array(7).fill(null).map(() => Array(5).fill(null));
                const records = parsedData.records;
        
                if (viewMode === 'teacher' && selectedTeacher) {
                    records.filter(r => r.teacher === selectedTeacher).forEach(item => {
                        const dayIndex = DAYS_OF_WEEK.indexOf(item.day);
                        const periodIndex = item.period - 1;
                        if (dayIndex !== -1 && periodIndex >= 0 && periodIndex < 7) {
                            grid[periodIndex][dayIndex] = {
                                topText: item.classId,
                                bottomText: isGrade3 ? '' : item.subject
                            };
                        }
                    });
                } else if (viewMode === 'class' && selectedClass) {
                    for (let p = 0; p < 7; p++) {
                        for (let d = 0; d < 5; d++) {
                            const matchingRecords = records.filter(r => r.classId === selectedClass && r.day === DAYS_OF_WEEK[d] && r.period === p + 1);
                            if (matchingRecords.length > 0) {
                                grid[p][d] = {
                                    topText: isGrade3 ? matchingRecords.map(r => r.teacher).join(', ') : matchingRecords[0].subject,
                                    bottomText: isGrade3 ? '' : matchingRecords.map(r => r.teacher).join(', ')
                                };
                            }
                        }
                    }
                    if (!isGrade3 && records.some(r => r.day === 'ìˆ˜' && r.period >= 5 && r.subject.includes('ì°½ì²´'))) {
                         grid[4][2] = { topText: 'ì°½ì²´', bottomText: 'ì°½ì²´' };
                         grid[5][2] = { topText: 'ì°½ì²´', bottomText: 'ì°½ì²´' };
                    }
                }
                return grid;
            }, [viewMode, selectedTeacher, selectedClass, parsedData.records, isGrade3]);
        
            const teacherTotalHours = useMemo(() => (viewMode === 'teacher' && selectedTeacher && parsedData.teacherHours) ? parsedData.teacherHours[selectedTeacher] ?? 0 : 0, [viewMode, selectedTeacher, parsedData.teacherHours]);
        
            const handleCellClick = useCallback((cell) => {
                if (!cell) return;
                const classId = viewMode === 'teacher' ? cell.topText : selectedClass;
                let subject, teacher;

                if (isGrade3) {
                    if (viewMode === 'teacher') {
                        subject = '';
                        teacher = selectedTeacher;
                    } else { // class view
                        subject = cell.topText; // This is actually the teacher's name
                        teacher = cell.topText;
                    }
                } else {
                     subject = viewMode === 'teacher' ? cell.bottomText : cell.topText;
                     teacher = viewMode === 'teacher' ? selectedTeacher : cell.bottomText;
                }
                onCellClick(subject, classId, teacher);
            }, [viewMode, selectedClass, selectedTeacher, onCellClick, isGrade3]);
        
            return (
                <div id="printable-area" className="printable bg-white p-4 md:p-8 rounded-lg shadow-2xl w-full space-y-6">
                    <header className="space-y-4">
                        <div className="relative text-center pb-4 border-b-2 border-gray-200">
                            <div className="absolute left-0 top-1/2 transform -translate-y-1/2">
                                <button onClick={onReset} className="px-4 py-2 bg-[#cc4125] hover:bg-[#b33a22] text-white font-bold rounded-lg shadow-md transition-colors text-base flex items-center gap-2 no-print">
                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" /></svg>ë’¤ë¡œ
                                </button>
                            </div>
                            <h1 className="text-2xl md:text-4xl font-bold tracking-tight text-black">
                                2026í•™ë…„ë„ {isGrade3 ? 'ê³ 3' : `${schoolInfo.semester}í•™ê¸°`} ì‹œê°„í‘œ
                            </h1>
                        </div>
                        <div className="flex flex-wrap justify-between items-center gap-4">
                            <div className="flex items-center gap-2 flex-shrink-0">
                                <button onClick={() => setViewMode('teacher')} className={`no-print px-4 py-2 text-lg md:px-6 md:py-3 md:text-xl font-bold rounded-md transition-all duration-300 shadow-md ${viewMode === 'teacher' ? 'bg-gradient-to-b from-green-500 to-green-600 text-white' : 'bg-gray-200 text-gray-800'}`}>êµì‚¬ë³„</button>
                                <button onClick={() => setViewMode('class')} className={`no-print px-4 py-2 text-lg md:px-6 md:py-3 md:text-xl font-bold rounded-md transition-all duration-300 shadow-md ${viewMode === 'class' ? 'bg-gradient-to-b from-green-500 to-green-600 text-white' : 'bg-gray-200 text-gray-800'}`}>í•™ê¸‰ë³„</button>
                            </div>
                            <div className="flex-grow flex justify-center w-full md:w-auto">
                                <div className="flex items-center bg-white shadow-md rounded-lg p-2 w-full max-w-[20rem]">
                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 text-gray-400 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                                    {viewMode === 'teacher' ? (
                                        <div className="flex items-center w-full justify-between overflow-hidden">
                                            <select value={selectedTeacher} onChange={(e) => setSelectedTeacher(e.target.value)} className="bg-transparent text-gray-900 font-bold focus:outline-none block w-full appearance-none text-center text-xl md:text-2xl truncate">
                                                {parsedData.teachers.filter(t => !t.includes('ê°€ìƒ')).map(t => <option key={t} value={t}>{t}</option>)}
                                            </select>
                                            {!isGrade3 && teacherTotalHours > 0 && <div className="bg-yellow-400 text-gray-800 font-bold px-3 py-1 rounded-md text-base whitespace-nowrap ml-2">{teacherTotalHours}ì‹œê°„</div>}
                                        </div>
                                    ) : (
                                        <select value={selectedClass} onChange={(e) => setSelectedClass(e.target.value)} className="bg-transparent text-gray-900 font-bold focus:outline-none block w-full appearance-none text-center text-xl md:text-2xl">
                                            {parsedData.classes.map(c => <option key={c} value={c}>{c}</option>)}
                                        </select>
                                    )}
                                </div>
                            </div>
                            <div className="flex justify-end flex-shrink-0">
                                 <button onClick={onPrint} className="px-5 py-2 bg-[#a64d79] hover:bg-[#8e4168] text-white font-bold rounded-lg shadow-md transition-colors text-lg no-print">ì¸ì‡„í•˜ê¸°</button>
                            </div>
                        </div>
                    </header>
                    <div><TimetableView gridData={gridData} days={DAYS_OF_WEEK} onCellClick={handleCellClick} /></div>
                </div>
            );
        };
        
        const StudentSearchView = ({ studentData2, studentData3, onReset, onPrint }) => {
            const GRADE_2_CODES = ['A', 'B', 'C', 'Ca', 'Cb', 'D', 'E'];
            const GRADE_3_CODES = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];
            const [searchQuery, setSearchQuery] = useState('');
            const [selectedGrade, setSelectedGrade] = useState('all');
            const [selectedClass, setSelectedClass] = useState('all');
            const { allStudents, allCodes, allClassNames } = useMemo(() => {
                if (!studentData2 || !studentData3) return { allStudents: [], allCodes: [], allClassNames: [] };
                const combinedData = [...studentData2.data, ...studentData3.data];
                const allHeaders = [...new Set([...studentData2.headers, ...studentData3.headers])];
                const transformed = combinedData.map(s => {
                    const choices = {};
                    allHeaders.forEach(h => { 
                        const c = s[h]; 
                        if(c) {
                            const shortName = Object.keys(SUBJECT_CODE_MAP).find(key => SUBJECT_CODE_MAP[key] === h) || h;
                            choices[c] = shortName;
                        }
                    });

                    if (s['í•™ë²ˆ'].startsWith('3')) {
                        const ungounCode = s['ìš´ë™ê³¼ ê±´ê°•'];
                        const changdokCode = s['ì°½ë…'];
                        
                        if (ungounCode && ungounCode === changdokCode) {
                            const ungounShort = Object.keys(SUBJECT_CODE_MAP).find(key => SUBJECT_CODE_MAP[key] === 'ìš´ë™ê³¼ ê±´ê°•') || 'ìš´ê±´';
                            const changdokShort = Object.keys(SUBJECT_CODE_MAP).find(key => SUBJECT_CODE_MAP[key] === 'ì°½ë…') || 'ì°½ë…';
                            choices[ungounCode] = `${ungounShort}/${changdokShort}`;
                        }
                    }
                    return { ...s, choices };
                });
                return { 
                    allStudents: transformed, 
                    allCodes: [...new Set(transformed.flatMap(s => Object.keys(s.choices)))].sort((a,b) => a.localeCompare(b, undefined, {numeric: true})), 
                    allClassNames: [...new Set(transformed.map(s => s['í•™ë²ˆ'].substring(0, 3)))].sort() 
                };
            }, [studentData2, studentData3]);
            const availableClasses = useMemo(() => selectedGrade === 'all' ? allClassNames : allClassNames.filter(c => c.startsWith(selectedGrade)), [allClassNames, selectedGrade]);
            useEffect(() => { setSelectedClass('all'); }, [selectedGrade]);
            const { filteredStudents, displayCodes } = useMemo(() => {
                let students = allStudents;
                if (selectedGrade !== 'all') { students = students.filter(s => s['í•™ë²ˆ'].startsWith(selectedGrade)); }
                if (selectedClass !== 'all') { students = students.filter(s => s['í•™ë²ˆ'].substring(0, 3) === selectedClass); }
                const query = searchQuery.trim().toLowerCase();
                if (query) { students = students.filter(s => s['ì´ë¦„'].toLowerCase().includes(query) || s['í•™ë²ˆ'].includes(query)); }
                
                let codes;
                if(selectedGrade === '2') codes = GRADE_2_CODES;
                else if (selectedGrade === '3') codes = GRADE_3_CODES;
                else codes = allCodes;

                return { filteredStudents: students, displayCodes: codes };
            }, [allStudents, searchQuery, selectedGrade, selectedClass, allCodes]);
            
            const filterDescription = useMemo(() => {
                if (selectedClass !== 'all') { return `${selectedClass.charAt(0)}í•™ë…„ ${parseInt(selectedClass.substring(1), 10)}ë°˜`; }
                if (selectedGrade !== 'all') { return `${selectedGrade}í•™ë…„ ì „ì²´`; }
                return 'ì „ì²´ í•™ë…„ / ì „ì²´ ë°˜';
            }, [selectedGrade, selectedClass]);

            return (
                <div id="student-printable-area" className="printable bg-white p-6 md:p-8 rounded-lg shadow-2xl w-full max-w-full space-y-4">
                    <header className="space-y-4">
                        <div className="relative text-center pb-4 border-b-2 border-gray-200">
                             <div className="absolute left-0 top-1/2 transform -translate-y-1/2"><button onClick={onReset} className="px-4 py-2 bg-[#cc4125] hover:bg-[#b33a22] text-white font-bold rounded-lg shadow-md transition-colors text-base flex items-center gap-2 no-print"><svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" /></svg>ë’¤ë¡œ</button></div>
                            <h1 className="text-2xl md:text-4xl font-bold tracking-tight text-black">í•™ìƒë³„ ì„ íƒê³¼ëª© ì¡°íšŒ</h1>
                             <div className="absolute right-0 top-1/2 transform -translate-y-1/2"><button onClick={onPrint} className="px-5 py-2 bg-[#a64d79] hover:bg-[#8e4168] text-white font-bold rounded-lg shadow-md transition-colors text-lg no-print">ì¸ì‡„í•˜ê¸°</button></div>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-3 items-center gap-4 p-4 bg-gray-50 rounded-lg no-print">
                            <div className="flex items-center gap-2">
                                <label className="font-bold text-lg">í•™ë…„:</label><select value={selectedGrade} onChange={e => setSelectedGrade(e.target.value)} className="p-2 border rounded-md"><option value="all">ì „ì²´</option><option value="2">2í•™ë…„</option><option value="3">3í•™ë…„</option></select>
                                <label className="font-bold text-lg ml-4">ë°˜:</label><select value={selectedClass} onChange={e => setSelectedClass(e.target.value)} className="p-2 border rounded-md"><option value="all">ì „ì²´</option>{availableClasses.map(c => <option key={c} value={c}>{`${c.charAt(0)}í•™ë…„ ${parseInt(c.substring(1), 10)}ë°˜`}</option>)}</select>
                            </div>
                            <div className="relative">
                                <input type="text" placeholder="í•™ìƒ ì´ë¦„ ë˜ëŠ” í•™ë²ˆìœ¼ë¡œ ê²€ìƒ‰..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} className="w-full p-3 pl-10 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 transition" />
                                <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg></div>
                            </div>
                            <div className="text-right font-bold text-lg text-gray-700">ê²€ìƒ‰ ê²°ê³¼: {filteredStudents.length}ëª…</div>
                        </div>
                    </header>
                    <div className="hidden print:flex justify-between items-center mb-2 px-1">
                        <span className="text-base font-bold">{filterDescription}</span>
                        <span className="text-base font-bold">ì¸ì›: {filteredStudents.length}ëª…</span>
                    </div>
                     <div className="overflow-x-auto shadow-md rounded-lg">
                        <table className="w-full text-sm text-left text-gray-700">
                            <thead className="text-xs text-gray-900 uppercase bg-blue-100 sticky top-0 border-b border-blue-200">
                                <tr>
                                    <th scope="col" className="px-2 py-2 whitespace-nowrap">ìˆœ</th>
                                    <th scope="col" className="px-2 py-2 whitespace-nowrap">í•™ë²ˆ</th>
                                    <th scope="col" className="px-2 py-2 whitespace-nowrap">ì´ë¦„</th>
                                    {displayCodes.map(code => <th key={code} scope="col" className="px-2 py-2 text-center whitespace-nowrap">{code}</th>)}
                                </tr>
                            </thead>
                            <tbody>
                                {filteredStudents.map((student, index) => (
                                    <tr key={student['í•™ë²ˆ']} className="bg-white border-b hover:bg-gray-50">
                                        <td className="px-2 py-1 text-center whitespace-nowrap">{index + 1}</td>
                                        <th scope="row" className="px-2 py-1 font-medium text-gray-900 whitespace-nowrap">{student['í•™ë²ˆ']}</th>
                                        <td className="px-2 py-1 whitespace-nowrap">{student['ì´ë¦„']}</td>
                                        {displayCodes.map(code => <td key={code} className="px-2 py-1 text-center whitespace-nowrap">{student.choices[code] || ''}</td>)}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                         {filteredStudents.length === 0 && <p className="text-center text-gray-500 py-10 no-print">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>}
                    </div>
                </div>
            )
        };

        const App = () => {
            const [isAuthenticated, setIsAuthenticated] = useState(true);
            const [currentView, setCurrentView] = useState('home');
            const [schoolInfo, setSchoolInfo] = useState(null);
            const [parsedData, setParsedData] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);
            const [studentData1, setStudentData1] = useState(null);
            const [studentData2, setStudentData2] = useState(null);
            const [studentData3, setStudentData3] = useState(null);
            const [studentData3Names, setStudentData3Names] = useState(null);
            const [studentAllData2, setStudentAllData2] = useState(null);
            const [modalData, setModalData] = useState(null);
            const [studentDetailModalData, setStudentDetailModalData] = useState(null);
            const [grade2Subjects, setGrade2Subjects] = useState([]);
            const [grade3Subjects, setGrade3Subjects] = useState([]);

            useEffect(() => {
                if (isAuthenticated && !studentData1) {
                    try {
                        setStudentData1(parseStudentCSV(studentCsvGrade1));
                        const sData2 = parseStudentCSV(studentCsvGrade2);
                        const sData3 = parseStudentCSV(studentCsvGrade3);
                        const sAllData2 = parseStudentCSV(studentCsvAllGrade2);
                        const sData3Names = parseStudentCSV(studentCsvGrade3Names);
                        setStudentData2(sData2);
                        setStudentData3(sData3);
                        setStudentAllData2(sAllData2);
                        setStudentData3Names(sData3Names);
                        setGrade2Subjects(sData2.headers);
                        setGrade3Subjects(sData3.headers);
                    } catch (e) {
                        setError("í•™ìƒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + e.message);
                        console.error(e);
                    }
                }
            }, [isAuthenticated]);
            
            const handleSemesterSelect = useCallback(async (semester) => {
                setIsLoading(true); setError(null);
                try {
                    const isGrade3 = semester === '3';
                    const csvData = semester === '1' ? semester1Csv : semester === '2' ? semester2Csv : semester3Csv;
                    const data = await parseTimetableCSV(csvData, isGrade3);
                    setParsedData(data);
                    const semesterText = isGrade3 ? 'ê³ 3' : semester;
                    setSchoolInfo({ year: '2026', semester: semesterText });
                    setCurrentView('timetable');
                } catch (err) { setError(`ë°ì´í„° ë¡œë”© ì‹¤íŒ¨: ${err.message}`); console.error(err); } 
                finally { setIsLoading(false); }
            }, []);
            const handleStudentSearchSelect = useCallback(() => setCurrentView('student_search'), []);
            const handleReset = useCallback(() => { setCurrentView('home'); setSchoolInfo(null); setParsedData(null); setError(null); }, []);

            const handleCellClick = useCallback((subjectString, classId, teacher) => {
                const isGrade3Click = schoolInfo?.semester === 'ê³ 3';

                if (isGrade3Click) {
                    const studentList = studentData3Names?.data;
                    if (!studentList) return;
                    const classStudents = studentList.filter(s => s['í•™ë²ˆ'].startsWith(classId)).map(s => ({ id: s['í•™ë²ˆ'], name: s['ì´ë¦„'], grade: '3' }));
                    if (classStudents.length > 0) {
                        setModalData({ subject: `${classId}ë°˜ ëª…ë‹¨`, students: classStudents, isElective: false, teacher: teacher });
                    }
                    return;
                }
                
                if (!subjectString || !classId) return;
                let subjectKey = null, code = null;
                const sortedKeys = Object.keys(SUBJECT_CODE_MAP).sort((a, b) => b.length - a.length);
                for (const key of sortedKeys) {
                    if (subjectString.endsWith(key)) {
                        subjectKey = key;
                        code = subjectString.substring(0, subjectString.length - key.length);
                        break;
                    }
                }

                if (subjectKey && code) {
                    const fullSubjectName = SUBJECT_CODE_MAP[subjectKey];
                    const grade = grade2Subjects.includes(fullSubjectName) ? '2' : '3';
                    const studentChoiceData = grade === '2' ? studentData2?.data : studentData3?.data;
                    if (!studentChoiceData) return;
                    const enrolledStudents = studentChoiceData.filter(s => s[fullSubjectName] === code).map(s => ({ id: s['í•™ë²ˆ'], name: s['ì´ë¦„'], grade }));
                    if (enrolledStudents.length > 0) setModalData({ subject: `${subjectString} (${fullSubjectName})`, students: enrolledStudents, isElective: true, teacher: teacher });
                } else {
                    const grade = classId.toString().charAt(0);
                    if (!['1', '2'].includes(grade)) return;
                    const studentList = grade === '1' ? studentData1?.data : studentAllData2?.data;
                    if (!studentList) return;
                    const classStudents = studentList.filter(s => s['í•™ë²ˆ'].startsWith(classId)).map(s => ({ id: s['í•™ë²ˆ'], name: s['ì´ë¦„'], grade }));
                    if (classStudents.length > 0) setModalData({ subject: `${classId}ë°˜ (${subjectString})`, students: classStudents, isElective: false, teacher: teacher });
                }
            }, [schoolInfo, studentData1, studentAllData2, studentData2, studentData3, studentData3Names, grade2Subjects, grade3Subjects]);


            const handleStudentNameClick = useCallback((student) => {
                const studentDataSource = student.grade === '2' ? studentData2?.data : studentData3?.data;
                if (!studentDataSource) return;
                const studentInfo = studentDataSource.find(s => s['í•™ë²ˆ'] === student.id);
                if (studentInfo) {
                    const selectedSubjects = Object.entries(studentInfo)
                        .filter(([key, value]) => value && key !== 'í•™ë²ˆ' && key !== 'ì´ë¦„')
                        .map(([subject, code]) => {
                            const shortName = Object.keys(SUBJECT_CODE_MAP).find(key => SUBJECT_CODE_MAP[key] === subject) || '';
                            return `${code}${shortName} (${subject})`;
                        });
                    setStudentDetailModalData({ name: `${student.id} ${student.name}`, subjects: selectedSubjects });
                }
            }, [studentData2, studentData3]);

            const handlePrint = (viewType) => {
                const elementId = viewType === 'student_search' ? 'student-printable-area' : 'printable-area';
                const printElement = document.getElementById(elementId);
                const body = document.body;

                if (printElement) {
                    if (viewType === 'student_search') body.classList.add('printing-landscape');
                    else body.classList.add('printing-portrait');

                    printElement.classList.add('printing');

                    setTimeout(() => {
                        window.print();
                        body.classList.remove('printing-landscape', 'printing-portrait');
                        printElement.classList.remove('printing');
                    }, 150);
                }
            };
            
            const renderView = () => {
                if (!isAuthenticated) return null; // ë¡œê·¸ì¸ í™”ë©´ì„ ê·¸ëƒ¥ ë Œë”ë§í•˜ì§€ ì•ŠìŒ
                switch (currentView) {
                    case 'timetable': return <TimetableScreen schoolInfo={schoolInfo} parsedData={parsedData} onReset={handleReset} onCellClick={handleCellClick} onPrint={() => handlePrint('timetable')} />;
                    case 'student_search': return <StudentSearchView studentData2={studentData2} studentData3={studentData3} onReset={handleReset} onPrint={() => handlePrint('student_search')} />;
                    default: return <HomeScreen onSemesterSelect={handleSemesterSelect} onStudentSearchSelect={handleStudentSearchSelect} isLoading={isLoading} error={error} />;
                }
            };
            
            return (
                <div className="bg-gray-100 min-h-screen flex flex-col items-center justify-center p-4">
                    <main className="w-full max-w-7xl mx-auto">
                        <StudentListModal modalData={modalData} onClose={() => setModalData(null)} onStudentClick={handleStudentNameClick} />
                        <StudentDetailModal modalData={studentDetailModalData} onClose={() => setStudentDetailModalData(null)} />
                        {renderView()}
                    </main>
                    {isAuthenticated && (
                         <footer className="w-full text-center text-gray-500 text-sm mt-8 no-print">
                            Â© 2026 KH KIM. All Rights Reserved.
                        </footer>
                    )}
                </div>
            );
        };
        
        const rootElement = document.getElementById('root');
        ReactDOM.createRoot(rootElement).render(<App />);
    </script>
</body>
</html>


